В классической механике уравнение Удвадия — Калабы представляет собой метод получения уравнений движения механической системы с ограничениями (связями). Уравнение было впервые получено Фирдаусом Э. Удвадия и Робертом Э. Калабой в 1992 году. Подход основан на принципе наименьшего принуждения Гаусса. Уравнение Удвадия — Калабы применимо к широкому классу связей, как голономных, так и неголономных, если они линейны относительно ускорений. Уравнение также можно обобщить на связи, которые не подчиняются принципу Даламбера.


== История ==
Уравнение Удвадия — Калабы было получено в 1992 году и описывает движение механической системы с механическими связями.Этот подход отличается от лагранжевого формализма, который использует множители Лагранжа для описания движения механических систем со связями и другие аналогичные подходы, такие как подход Гиббса — Аппеля. Физическая интерпретация уравнения имеет важное значение в областях, выходящих за рамки классической механики, таких как управление сильно нелинейными общими динамическими системами.


== Основная задача движения со связями ==
При изучении динамики механических систем, конфигурация данной системы S, как правило, полностью описывается n обобщёнными координатами, так что её обобщённый координатный n- вектор-столбец задаётся

  
    
      
        
          q
        
        :=
        [
        
          q
          
            1
          
        
        ,
        
          q
          
            2
          
        
        ,
        …
        ,
        
          q
          
            n
          
        
        
          ]
          
            
              T
            
          
        
        .
      
    
    {\displaystyle \mathbf {q} :=[q_{1},q_{2},\ldots ,q_{n}]^{\mathrm {T} }.}
  где Т обозначает операция транспонирования. Используя ньютоновскую или лагранжеву динамику, уравнения движения исследуемой системы S без связей можно записать в виде матричного уравнения (см. Матричное умножение):

где точки обозначают производные по времени:

  
    
      
        
          
            
              
                q
                ˙
              
            
          
          
            i
          
        
        =
        
          
            
              d
              
                q
                
                  i
                
              
            
            
              d
              t
            
          
        
        
        .
      
    
    {\displaystyle {\dot {q}}_{i}={\frac {dq_{i}}{dt}}\,.}
  Предполагается, что начальные условия q (0) и 
  
    
      
        
          
            
              
                q
              
              ˙
            
          
        
        (
        0
        )
      
    
    {\displaystyle {\dot {\mathbf {q} }}(0)}
   заданы. Систему S называют неограниченной, если вектор скоростей 
  
    
      
        
          
            
              
                q
              
              ˙
            
          
        
        (
        0
        )
      
    
    {\displaystyle {\dot {\mathbf {q} }}(0)}
   можно задать произвольно.
n-вектор Q обозначает полную обобщённую силу, действующую на систему благодаря некоторым внешним воздействиям; она может представлять собой как сумму всех консервативных сил, так и неконсервативных сил.
nxn матрица M симметрична, и она может быть как положительно определённой 
  
    
      
        (
        
          M
        
        >
        0
        )
      
    
    {\displaystyle (\mathbf {M} >0)}
  так и полуположительно определённый 
  
    
      
        (
        
          M
        
        ≥
        0
        )
      
    
    {\displaystyle (\mathbf {M} \geq 0)}
  . Как правило, предполагается, что М положительно определённа; тем не менее, нередко неограниченные уравнения движения системы S получаются и при полуположительно определённой M, когда массовая матрица оказывается сингулярной, то есть для которой не существует обратной матрицы.


=== Связи ===
Теперь предположим, что на неограниченную систему S налагается множество m согласованных связей вида

  
    
      
        
          A
        
        (
        q
        ,
        
          
            
              q
              ˙
            
          
        
        ,
        t
        )
        
          
            
              
                q
              
              ¨
            
          
        
        =
        
          b
        
        (
        q
        ,
        
          
            
              q
              ˙
            
          
        
        ,
        t
        )
        ,
      
    
    {\displaystyle \mathbf {A} (q,{\dot {q}},t){\ddot {\mathbf {q} }}=\mathbf {b} (q,{\dot {q}},t),}
  где A — известная m- by- n матрица ранга r, а b — известный m- вектор. Отметим, что такой набор уравнений связей охватывает очень большое разнообразие связей голономного и неголономного характера. Например, голономные связи вида

  
    
      
        φ
        (
        q
        ,
        t
        )
        =
        0
      
    
    {\displaystyle \varphi (q,t)=0}
  дифференцируются дважды по времени, в то время как неголономные связи вида

  
    
      
        ψ
        (
        q
        ,
        
          
            
              q
              ˙
            
          
        
        ,
        t
        )
        =
        0
      
    
    {\displaystyle \psi (q,{\dot {q}},t)=0}
  можно дифференцировать один раз по времени, чтобы получить m- by- n матрицу A и m -вектор b . То есть связи, могут быть следующих типов

нелинейные функции перемещения и скорости,
явно зависящие времени, и
функционально зависимые.Вследствие наличия этих связей в неограниченной системе S возникают дополнительные силы, а именно силы связей. Следовательно, для ограниченной системы Sc можно записать

где Qc — сила связи — это дополнительная сила, необходимая для удовлетворения наложенным ограничениям. Основная задача движения с связями теперь формулируется следующим образом:

заданы неограниченные уравнения движения системы S,
заданы обобщённые координаты q(t) и обобщенные скорости 
  
    
      
        
          
            
              q
              ˙
            
          
        
        (
        t
        )
      
    
    {\displaystyle {\dot {q}}(t)}
   ограниченной системы Sc в момент времени t, и
заданы связи в виде 
  
    
      
        
          A
        
        
          
            
              q
              ¨
            
          
        
        =
        
          b
        
      
    
    {\displaystyle \mathbf {A} {\ddot {q}}=\mathbf {b} }
   указаном выше,найти уравнения движения для ограниченной системы — ускорения — в момент времени t, что соответствует принципами аналитической динамики.


== Уравнение движения ==
Решение основной задачи даётся уравнением Удвадия — Калабы. Когда матрица M положительно определена, уравнение движения ограниченной системы Sc в каждый момент времени имеет вид

  
    
      
        
          M
        
        
          
            
              
                q
              
              ¨
            
          
        
        =
        
          Q
        
        +
        
          
            M
          
          
            1
            
              /
            
            2
          
        
        
          
            (
            
              
                A
              
              
                
                  M
                
                
                  −
                  1
                  
                    /
                  
                  2
                
              
            
            )
          
          
            +
          
        
        (
        
          b
        
        −
        
          A
        
        
          
            M
          
          
            −
            1
          
        
        
          Q
        
        )
        ,
      
    
    {\displaystyle \mathbf {M} {\ddot {\mathbf {q} }}=\mathbf {Q} +\mathbf {M} ^{1/2}\left(\mathbf {A} \mathbf {M} ^{-1/2}\right)^{+}(\mathbf {b} -\mathbf {A} \mathbf {M} ^{-1}\mathbf {Q} ),}
  где символ «+» обозначает псевдообратную матрицу 
  
    
      
        
          A
        
        
          
            M
          
          
            −
            1
            
              /
            
            2
          
        
      
    
    {\displaystyle \mathbf {A} \mathbf {M} ^{-1/2}}
   , Таким образом, сила связи задаётся в явном виде как

  
    
      
        
          
            Q
          
          
            c
          
        
        =
        
          
            M
          
          
            1
            
              /
            
            2
          
        
        
          
            (
            
              
                A
              
              
                
                  M
                
                
                  −
                  1
                  
                    /
                  
                  2
                
              
            
            )
          
          
            +
          
        
        (
        
          b
        
        −
        
          A
        
        
          
            M
          
          
            −
            1
          
        
        
          Q
        
        )
        ,
      
    
    {\displaystyle \mathbf {Q} _{c}=\mathbf {M} ^{1/2}\left(\mathbf {A} \mathbf {M} ^{-1/2}\right)^{+}(\mathbf {b} -\mathbf {A} \mathbf {M} ^{-1}\mathbf {Q} ),}
  и поскольку матрица M положительно определена, то обобщённое ускорение ограниченной системы Sc запишется в виде

  
    
      
        
          
            
              
                q
              
              ¨
            
          
        
        =
        
          
            M
          
          
            −
            1
          
        
        
          Q
        
        +
        
          
            M
          
          
            −
            1
            
              /
            
            2
          
        
        
          
            (
            
              
                A
              
              
                
                  M
                
                
                  −
                  1
                  
                    /
                  
                  2
                
              
            
            )
          
          
            +
          
        
        (
        
          b
        
        −
        
          A
        
        
          
            M
          
          
            −
            1
          
        
        
          Q
        
        )
        .
      
    
    {\displaystyle {\ddot {\mathbf {q} }}=\mathbf {M} ^{-1}\mathbf {Q} +\mathbf {M} ^{-1/2}\left(\mathbf {A} \mathbf {M} ^{-1/2}\right)^{+}(\mathbf {b} -\mathbf {A} \mathbf {M} ^{-1}\mathbf {Q} ).}
  В случае, если матрица M является полуположительно определённой 
  
    
      
        (
        
          M
        
        ≥
        0
        )
      
    
    {\displaystyle (\mathbf {M} \geq 0)}
   вышеприведённое уравнение нельзя использовать напрямую, поскольку M может оказаться сингулярной. Кроме того, обобщённые ускорения могут быть не единственными, кроме случая, когда (n + m) x n матрица

  
    
      
        
          
            
              
                M
              
              ^
            
          
        
        =
        
          [
          
            
              
                
                  
                    M
                  
                
              
              
                
                  
                    A
                  
                
              
            
          
          ]
        
      
    
    {\displaystyle {\hat {\mathbf {M} }}=\left[{\begin{array}{c}\mathbf {M} \\\mathbf {A} \end{array}}\right]}
  имеет полный ранг = n. Но поскольку наблюдаемые ускорения механических систем в природе всегда уникальны, то это условие, накладываемое на ранг, является необходимым и достаточным условием для получения однозначно определённых обобщённых ускорений ограниченной системы Sc в каждый момент времени. Таким образом, когда 
  
    
      
        
          
            
              
                M
              
              ^
            
          
        
      
    
    {\displaystyle {\hat {\mathbf {M} }}}
   имеет полный ранг, уравнения движения ограниченной системы Sc в каждый момент времени однозначно определяются путем (1) создания вспомогательной неограниченной системы

  
    
      
        
          
            M
          
          
            
              A
            
          
        
        
          
            
              
                q
              
              ¨
            
          
        
        :=
        (
        
          M
        
        +
        
          
            A
          
          
            +
          
        
        
          A
        
        )
        
          
            
              
                q
              
              ¨
            
          
        
        =
        
          Q
        
        +
        
          
            A
          
          
            +
          
        
        
          b
        
        :=
        
          
            Q
          
          
            
              b
            
          
        
        ,
      
    
    {\displaystyle \mathbf {M} _{\mathbf {A} }{\ddot {\mathbf {q} }}:=(\mathbf {M} +\mathbf {A} ^{+}\mathbf {A} ){\ddot {\mathbf {q} }}=\mathbf {Q} +\mathbf {A} ^{+}\mathbf {b} :=\mathbf {Q} _{\mathbf {b} },}
  и (2) применяя фундаментальное уравнение для движения со связями к этой вспомогательной неограниченной системе так, чтобы вспомогательные уравнения движения со связями были явно заданы в

  
    
      
        
          
            M
          
          
            
              A
            
          
        
        
          
            
              
                q
              
              ¨
            
          
        
        =
        
          
            Q
          
          
            
              b
            
          
        
        +
        
          
            M
          
          
            
              A
            
          
          
            1
            
              /
            
            2
          
        
        (
        
          A
        
        
          
            M
          
          
            
              A
            
          
          
            −
            1
            
              /
            
            2
          
        
        
          )
          
            +
          
        
        (
        
          b
        
        −
        
          A
        
        
          
            M
          
          
            
              A
            
          
          
            −
            1
          
        
        
          
            Q
          
          
            
              b
            
          
        
        )
        .
      
    
    {\displaystyle \mathbf {M} _{\mathbf {A} }{\ddot {\mathbf {q} }}=\mathbf {Q} _{\mathbf {b} }+\mathbf {M} _{\mathbf {A} }^{1/2}(\mathbf {A} \mathbf {M} _{\mathbf {A} }^{-1/2})^{+}(\mathbf {b} -\mathbf {A} \mathbf {M} _{\mathbf {A} }^{-1}\mathbf {Q} _{\mathbf {b} }).}
  Кроме того, если матрица 
  
    
      
        
          
            
              
                M
              
              ^
            
          
        
      
    
    {\displaystyle {\hat {\mathbf {M} }}}
   имеет полный ранг, то матрица 
  
    
      
        
          
            M
          
          
            
              A
            
          
        
      
    
    {\displaystyle \mathbf {M} _{\mathbf {A} }}
   всегда положительно определена. Это явно даёт обобщенные ускорения ограниченной системы Sc в виде

  
    
      
        
          
            
              
                q
              
              ¨
            
          
        
        =
        
          
            M
          
          
            
              A
            
          
          
            −
            1
          
        
        
          
            Q
          
          
            
              b
            
          
        
        +
        
          
            M
          
          
            
              A
            
          
          
            −
            1
            
              /
            
            2
          
        
        (
        
          A
        
        
          
            M
          
          
            
              A
            
          
          
            −
            1
            
              /
            
            2
          
        
        
          )
          
            +
          
        
        (
        
          b
        
        −
        
          A
        
        
          
            M
          
          
            
              A
            
          
          
            −
            1
          
        
        
          
            Q
          
          
            
              b
            
          
        
        )
        .
      
    
    {\displaystyle {\ddot {\mathbf {q} }}=\mathbf {M} _{\mathbf {A} }^{-1}\mathbf {Q} _{\mathbf {b} }+\mathbf {M} _{\mathbf {A} }^{-1/2}(\mathbf {A} \mathbf {M} _{\mathbf {A} }^{-1/2})^{+}(\mathbf {b} -\mathbf {A} \mathbf {M} _{\mathbf {A} }^{-1}\mathbf {Q} _{\mathbf {b} }).}
  Это уравнение справедливо, когда матрица M является либо положительно определённой, либо положительной полуопределенной. Если сила связи, которая заставляет ограниченную систему S c — систему, которая может иметь сингулярную массовую матрицу M — удовлетворяет наложенным связям, то она явно задается в виде

  
    
      
        
          
            Q
          
          
            c
          
        
        =
        
          
            M
          
          
            
              A
            
          
          
            1
            
              /
            
            2
          
        
        (
        
          A
        
        
          
            M
          
          
            
              A
            
          
          
            −
            1
            
              /
            
            2
          
        
        
          )
          
            +
          
        
        (
        
          b
        
        −
        
          A
        
        
          
            M
          
          
            
              A
            
          
          
            −
            1
          
        
        
          
            Q
          
          
            
              b
            
          
        
        )
        .
      
    
    {\displaystyle \mathbf {Q} _{c}=\mathbf {M} _{\mathbf {A} }^{1/2}(\mathbf {A} \mathbf {M} _{\mathbf {A} }^{-1/2})^{+}(\mathbf {b} -\mathbf {A} \mathbf {M} _{\mathbf {A} }^{-1}\mathbf {Q} _{\mathbf {b} }).}
  


== Неидеальные связи ==
В любое время во время движения можно рассмотреть возмущение системы как виртуальные смещения δr, согласующимися с ограничениями системы. Смещение может быть либо обратимым, либо необратимым. Если смещение необратимо, то оно выполняет виртуальную работу. Можно записать виртуальную работу смещения как

  
    
      
        
          W
          
            c
          
        
        (
        t
        )
        =
        
          
            C
          
          
            
              T
            
          
        
        (
        q
        ,
        
          
            
              q
              ˙
            
          
        
        ,
        t
        )
        δ
        
          r
        
        (
        t
        )
      
    
    {\displaystyle W_{c}(t)=\mathbf {C} ^{\mathrm {T} }(q,{\dot {q}},t)\delta \mathbf {r} (t)}
  Здесь вектор 
  
    
      
        
          C
        
        (
        q
        ,
        
          
            
              q
              ˙
            
          
        
        ,
        t
        )
      
    
    {\displaystyle \mathbf {C} (q,{\dot {q}},t)}
   описывает неидеальность виртуальной работы, которая может быть связана, например, с силами трения или сопротивления (такие силы зависят от скорости). Это обобщенный принцип Даламбера, где обычная форма принципа задаётся исчезающей виртуальной работой с 
  
    
      
        
          C
        
        (
        q
        ,
        
          
            
              q
              ˙
            
          
        
        ,
        t
        )
        =
        0
      
    
    {\displaystyle \mathbf {C} (q,{\dot {q}},t)=0}
  .
Уравнение Удвадия — Калабы модифицируется с использованием дополнительного слагаемого отвечающим за неидеальные связи

  
    
      
        
          M
        
        
          
            
              
                q
              
              ¨
            
          
        
        =
        
          Q
        
        +
        
          
            M
          
          
            1
            
              /
            
            2
          
        
        
          
            (
            
              
                A
              
              
                
                  M
                
                
                  −
                  1
                  
                    /
                  
                  2
                
              
            
            )
          
          
            +
          
        
        (
        
          b
        
        −
        
          A
        
        
          
            M
          
          
            −
            1
          
        
        
          Q
        
        )
        +
        
          
            M
          
          
            1
            
              /
            
            2
          
        
        
          [
          
            
              I
            
            −
            
              
                (
                
                  
                    A
                  
                  
                    
                      M
                    
                    
                      −
                      1
                      
                        /
                      
                      2
                    
                  
                
                )
              
              
                +
              
            
            
              A
            
            
              
                M
              
              
                −
                1
                
                  /
                
                2
              
            
          
          ]
        
        
          
            M
          
          
            −
            1
            
              /
            
            2
          
        
        
          C
        
      
    
    {\displaystyle \mathbf {M} {\ddot {\mathbf {q} }}=\mathbf {Q} +\mathbf {M} ^{1/2}\left(\mathbf {A} \mathbf {M} ^{-1/2}\right)^{+}(\mathbf {b} -\mathbf {A} \mathbf {M} ^{-1}\mathbf {Q} )+\mathbf {M} ^{1/2}\left[\mathbf {I} -\left(\mathbf {A} \mathbf {M} ^{-1/2}\right)^{+}\mathbf {A} \mathbf {M} ^{-1/2}\right]\mathbf {M} ^{-1/2}\mathbf {C} }
  


== Примеры ==


=== Обратная задача Кеплера ===
Метод позволяет найти решение обратной задачи Кеплера об определении закона для силы, который соответствует орбитам, в виде конических сечений. Пусть отсутствуют внешние силы (даже гравитации), и вместо этого ограничиваем движение частицы, которая следует орбите вида

  
    
      
        r
        =
        ϵ
        x
        +
        l
      
    
    {\displaystyle r=\epsilon x+l}
  где 
  
    
      
        r
        =
        
          
            
              x
              
                2
              
            
            +
            
              y
              
                2
              
            
          
        
      
    
    {\displaystyle r={\sqrt {x^{2}+y^{2}}}}
  , 
  
    
      
        ϵ
      
    
    {\displaystyle \epsilon }
   — эксцентриситет, а l — полуось. Дифференцирование дважды по времени и небольшая перегруппировка даёт связь

  
    
      
        (
        x
        −
        r
        ϵ
        )
        
          
            
              x
              ¨
            
          
        
        +
        y
        
          
            
              y
              ¨
            
          
        
        =
        −
        
          
            
              (
              x
              
                
                  
                    y
                    ˙
                  
                
              
              −
              y
              
                
                  
                    x
                    ˙
                  
                
              
              
                )
                
                  2
                
              
            
            
              r
              
                2
              
            
          
        
      
    
    {\displaystyle (x-r\epsilon ){\ddot {x}}+y{\ddot {y}}=-{\frac {(x{\dot {y}}-y{\dot {x}})^{2}}{r^{2}}}}
  Предположим, что тело имеет постоянную массу, и что момент импульса вокруг фокуса сохраняется

  
    
      
        m
        (
        x
        
          
            
              y
              ˙
            
          
        
        −
        y
        
          
            
              x
              ˙
            
          
        
        )
        =
        L
      
    
    {\displaystyle m(x{\dot {y}}-y{\dot {x}})=L}
  с производной по времени

  
    
      
        x
        
          
            
              y
              ¨
            
          
        
        −
        y
        
          
            
              x
              ¨
            
          
        
        =
        0
      
    
    {\displaystyle x{\ddot {y}}-y{\ddot {x}}=0}
  Две связи объединяются в матричное уравнение

  
    
      
        
          
            (
            
              
                
                  x
                  −
                  r
                  ϵ
                
                
                  y
                
              
              
                
                  y
                
                
                  −
                  x
                
              
            
            )
          
        
        
          
            (
            
              
                
                  
                    
                      
                        x
                        ¨
                      
                    
                  
                
              
              
                
                  
                    
                      
                        y
                        ¨
                      
                    
                  
                
              
            
            )
          
        
        =
        
          
            (
            
              
                
                  −
                  
                    
                      
                        L
                        
                          2
                        
                      
                      
                        
                          m
                          
                            2
                          
                        
                        
                          r
                          
                            2
                          
                        
                      
                    
                  
                
              
              
                
                  0
                
              
            
            )
          
        
      
    
    {\displaystyle {\begin{pmatrix}x-r\epsilon &y\\y&-x\end{pmatrix}}{\begin{pmatrix}{\ddot {x}}\\{\ddot {y}}\end{pmatrix}}={\begin{pmatrix}-{\frac {L^{2}}{m^{2}r^{2}}}\\0\end{pmatrix}}}
  Обратная для матрицы связей

  
    
      
        
          
            
              (
              
                
                  
                    x
                    −
                    r
                    ϵ
                  
                  
                    y
                  
                
                
                  
                    y
                  
                  
                    −
                    x
                  
                
              
              )
            
          
          
            −
            1
          
        
        =
        
          
            1
            
              l
              r
            
          
        
        
          
            (
            
              
                
                  x
                
                
                  y
                
              
              
                
                  y
                
                
                  −
                  (
                  x
                  −
                  r
                  ϵ
                  )
                
              
            
            )
          
        
      
    
    {\displaystyle {\begin{pmatrix}x-r\epsilon &y\\y&-x\end{pmatrix}}^{-1}={\frac {1}{lr}}{\begin{pmatrix}x&y\\y&-(x-r\epsilon )\end{pmatrix}}}
  Следовательно, ограничивающая сила — это ожидаемый закон обратных квадратов

  
    
      
        
          
            F
          
          
            c
          
        
        =
        m
        
          
            A
          
          
            −
            1
          
        
        
          b
        
        =
        
          
            m
            
              l
              r
            
          
        
        
          
            (
            
              
                
                  x
                
                
                  y
                
              
              
                
                  y
                
                
                  −
                  (
                  x
                  −
                  r
                  ϵ
                  )
                
              
            
            )
          
        
        
          
            (
            
              
                
                  −
                  
                    
                      
                        L
                        
                          2
                        
                      
                      
                        
                          m
                          
                            2
                          
                        
                        
                          r
                          
                            2
                          
                        
                      
                    
                  
                
              
              
                
                  0
                
              
            
            )
          
        
        =
        −
        
          
            
              L
              
                2
              
            
            
              m
              l
              
                r
                
                  2
                
              
            
          
        
        
          
            (
            
              
                
                  cos
                  ⁡
                  
                    θ
                  
                
              
              
                
                  sin
                  ⁡
                  
                    θ
                  
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {F} _{c}=m\mathbf {A} ^{-1}\mathbf {b} ={\frac {m}{lr}}{\begin{pmatrix}x&y\\y&-(x-r\epsilon )\end{pmatrix}}{\begin{pmatrix}-{\frac {L^{2}}{m^{2}r^{2}}}\\0\end{pmatrix}}=-{\frac {L^{2}}{mlr^{2}}}{\begin{pmatrix}\cos {\theta }\\\sin {\theta }\end{pmatrix}}}
  


=== Наклонная плоскость с трением ===
Рассмотрим небольшой блок постоянной массы на наклонной плоскости с углом 
  
    
      
        α
      
    
    {\displaystyle \alpha }
   к горизонтали. Ограничение на то, что блок лежит на плоскости, можно записать в виде

  
    
      
        y
        =
        x
        tan
        ⁡
        
          α
        
      
    
    {\displaystyle y=x\tan {\alpha }}
  Взяв две производные по времени, стандартная форма уравнения для матрицы связей представляется в виде

  
    
      
        
          
            (
            
              
                
                  −
                  tan
                  ⁡
                  
                    α
                  
                
                
                  1
                
              
            
            )
          
        
        
          
            (
            
              
                
                  
                    
                      
                        x
                        ¨
                      
                    
                  
                
              
              
                
                  
                    
                      
                        y
                        ¨
                      
                    
                  
                
              
            
            )
          
        
        =
        0
      
    
    {\displaystyle {\begin{pmatrix}-\tan {\alpha }&1\end{pmatrix}}{\begin{pmatrix}{\ddot {x}}\\{\ddot {y}}\end{pmatrix}}=0}
  У матрицы связей есть псевдообратная

  
    
      
        
          
            
              (
              
                
                  
                    −
                    tan
                    ⁡
                    
                      α
                    
                  
                  
                    1
                  
                
              
              )
            
          
          
            +
          
        
        =
        
          cos
          
            2
          
        
        ⁡
        
          α
        
        
          
            (
            
              
                
                  −
                  tan
                  ⁡
                  
                    α
                  
                
              
              
                
                  1
                
              
            
            )
          
        
      
    
    {\displaystyle {\begin{pmatrix}-\tan {\alpha }&1\end{pmatrix}}^{+}=\cos ^{2}{\alpha }{\begin{pmatrix}-\tan {\alpha }\\1\end{pmatrix}}}
  Допускается скольжение трения между блоком и наклонной плоскостью. Параметризуется эта силу стандартным коэффициентом трения, умноженным на нормальную силу

  
    
      
        
          C
        
        =
        −
        μ
        m
        g
        cos
        ⁡
        
          α
        
        sgn
        ⁡
        
          
            
              y
              ˙
            
          
        
        
          
            (
            
              
                
                  cos
                  ⁡
                  
                    α
                  
                
              
              
                
                  sin
                  ⁡
                  
                    α
                  
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {C} =-\mu mg\cos {\alpha }\operatorname {sgn} {\dot {y}}{\begin{pmatrix}\cos {\alpha }\\\sin {\alpha }\end{pmatrix}}}
  В то время как сила тяжести обратима, сила трения — нет. Следовательно, виртуальная работа, связанная с виртуальным смещением, будет зависеть от C. Просуммировав три силы (внешнюю, идеальную связь и неидеальную связь) следующим образом:

  
    
      
        
          
            F
          
          
            e
            x
            t
          
        
        =
        
          Q
        
        =
        −
        m
        g
        
          
            (
            
              
                
                  0
                
              
              
                
                  y
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {F} _{ext}=\mathbf {Q} =-mg{\begin{pmatrix}0\\y\end{pmatrix}}}
  

  
    
      
        
          
            F
          
          
            c
            ,
            i
          
        
        =
        −
        
          
            A
          
          
            +
          
        
        
          A
        
        
          Q
        
        =
        m
        g
        
          cos
          
            2
          
        
        ⁡
        
          α
        
        
          
            (
            
              
                
                  −
                  tan
                  ⁡
                  
                    α
                  
                
              
              
                
                  1
                
              
            
            )
          
        
        
          
            (
            
              
                
                  −
                  tan
                  ⁡
                  
                    α
                  
                
                
                  1
                
              
            
            )
          
        
        
          
            (
            
              
                
                  0
                
              
              
                
                  y
                
              
            
            )
          
        
        =
        m
        g
        
          
            (
            
              
                
                  −
                  sin
                  ⁡
                  
                    α
                  
                  cos
                  ⁡
                  
                    α
                  
                
              
              
                
                  
                    cos
                    
                      2
                    
                  
                  ⁡
                  
                    α
                  
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {F} _{c,i}=-\mathbf {A} ^{+}\mathbf {A} \mathbf {Q} =mg\cos ^{2}{\alpha }{\begin{pmatrix}-\tan {\alpha }\\1\end{pmatrix}}{\begin{pmatrix}-\tan {\alpha }&1\end{pmatrix}}{\begin{pmatrix}0\\y\end{pmatrix}}=mg{\begin{pmatrix}-\sin {\alpha }\cos {\alpha }\\\cos ^{2}{\alpha }\end{pmatrix}}}
  

  
    
      
        
          
            F
          
          
            c
            ,
            n
            i
          
        
        =
        (
        
          I
        
        −
        
          
            A
          
          
            +
          
        
        
          A
        
        )
        
          C
        
        =
        −
        μ
        m
        g
        cos
        ⁡
        
          α
        
        sgn
        ⁡
        
          
            
              y
              ˙
            
          
        
        
          [
          
            
              
                (
                
                  
                    
                      1
                    
                    
                      0
                    
                  
                  
                    
                      0
                    
                    
                      1
                    
                  
                
                )
              
            
            −
            
              cos
              
                2
              
            
            ⁡
            
              α
            
            
              
                (
                
                  
                    
                      −
                      tan
                      ⁡
                      
                        α
                      
                    
                  
                  
                    
                      1
                    
                  
                
                )
              
            
            
              
                (
                
                  
                    
                      −
                      tan
                      ⁡
                      
                        α
                      
                    
                    
                      1
                    
                  
                
                )
              
            
          
          ]
        
        =
        −
        μ
        m
        g
        cos
        ⁡
        
          α
        
        sgn
        ⁡
        
          
            
              y
              ˙
            
          
        
        
          
            (
            
              
                
                  
                    cos
                    
                      2
                    
                  
                  ⁡
                  
                    α
                  
                
              
              
                
                  sin
                  ⁡
                  
                    α
                  
                  cos
                  ⁡
                  
                    α
                  
                
              
            
            )
          
        
      
    
    {\displaystyle \mathbf {F} _{c,ni}=(\mathbf {I} -\mathbf {A} ^{+}\mathbf {A} )\mathbf {C} =-\mu mg\cos {\alpha }\operatorname {sgn} {\dot {y}}\left[{\begin{pmatrix}1&0\\0&1\end{pmatrix}}-\cos ^{2}{\alpha }{\begin{pmatrix}-\tan {\alpha }\\1\end{pmatrix}}{\begin{pmatrix}-\tan {\alpha }&1\end{pmatrix}}\right]=-\mu mg\cos {\alpha }\operatorname {sgn} {\dot {y}}{\begin{pmatrix}\cos ^{2}{\alpha }\\\sin {\alpha }\cos {\alpha }\end{pmatrix}}}
  Объединяя вышесказанное, уравнения движения

  
    
      
        
          
            (
            
              
                
                  
                    
                      
                        x
                        ¨
                      
                    
                  
                
              
              
                
                  
                    
                      
                        y
                        ¨
                      
                    
                  
                
              
            
            )
          
        
        =
        
          
            1
            m
          
        
        
          (
          
            
              
                F
              
              
                e
                x
                t
              
            
            +
            
              
                F
              
              
                c
                ,
                i
              
            
            +
            
              
                F
              
              
                c
                ,
                n
                i
              
            
          
          )
        
        =
        −
        g
        
          (
          
            sin
            ⁡
            
              α
            
            +
            μ
            cos
            ⁡
            
              α
            
            sgn
            ⁡
            
              
                
                  y
                  ˙
                
              
            
          
          )
        
        
          
            (
            
              
                
                  cos
                  ⁡
                  
                    α
                  
                
              
              
                
                  sin
                  ⁡
                  
                    α
                  
                
              
            
            )
          
        
      
    
    {\displaystyle {\begin{pmatrix}{\ddot {x}}\\{\ddot {y}}\end{pmatrix}}={\frac {1}{m}}\left(\mathbf {F} _{ext}+\mathbf {F} _{c,i}+\mathbf {F} _{c,ni}\right)=-g\left(\sin {\alpha }+\mu \cos {\alpha }\operatorname {sgn} {\dot {y}}\right){\begin{pmatrix}\cos {\alpha }\\\sin {\alpha }\end{pmatrix}}}
  Это похоже на постоянное ускорение направленное вниз из-за гравитации с небольшой модификацией. Если блок движется вверх по наклонной плоскости, то трение увеличивает ускорение. Если блок движется вниз по наклонной плоскости, то трение уменьшает ускорение.


== Примечания ==